

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Getting Started with the CKG Build &mdash; ClinicalKnowledgeGraph 1.0.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Connecting to the Clinical Knowledge Graph database" href="../getting_started/connect-to-ckg.html" />
    <link rel="prev" title="Getting Started with Neo4j" href="getting-started-with-neo4j.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> ClinicalKnowledgeGraph
          

          
          </a>

          
            
            
              <div class="version">
                1.0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../INTRO.html">Clinical Knowledge Graph</a></li>
</ul>
<p class="caption"><span class="caption-text">First steps</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getting-started-with-requirements.html">Getting Started with some Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting-started-with-neo4j.html">Getting Started with Neo4j</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Getting Started with the CKG Build</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#create-a-virtual-environment">Create a virtual environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="#setting-up-the-clinical-knowledge-graph">Setting up the Clinical Knowledge Graph</a></li>
<li class="toctree-l2"><a class="reference internal" href="#add-ckg-to-bashrc">Add CKG to <em>.bashrc</em></a></li>
<li class="toctree-l2"><a class="reference internal" href="#build-neo4j-graph-database">Build Neo4j graph database</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#from-builder-py">From builder.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="#from-a-backup-dump-file">From a backup dump file</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/connect-to-ckg.html">Connecting to the Clinical Knowledge Graph database</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/create-new-user.html">Create a new user in the graph database</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/create-new-project.html">Create a new project in the database</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/upload-data.html">Upload project experimental data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/data-analysis-config.html">Define data analysis parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/access-report.html">Accessing the analysis report</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/notifications.html">Report notifications</a></li>
</ul>
<p class="caption"><span class="caption-text">Project Report</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../project_report/project-report.html">Generating a project report</a></li>
<li class="toctree-l1"><a class="reference internal" href="../project_report/project-tabs.html">Project report tabs</a></li>
</ul>
<p class="caption"><span class="caption-text">CKG Builder</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../ckg_builder/ontologies.html">Ontology sources and raw file parsers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ckg_builder/databases.html">Biomedical databases and resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ckg_builder/experiments.html">Parsing experimental data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ckg_builder/graphdb-builder.html">Building the graph database from one Python module</a></li>
</ul>
<p class="caption"><span class="caption-text">Advanced Features</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../advanced_features/import-statistics.html">Clinical Knowledge Graph Statistics: Imports</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced_features/graphdb-statistics.html">Clinical Knowledge Graph Statistics: Database</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced_features/ckg-notebooks.html">Using Jupyter Notebooks with the Clinical Knowledge Graph</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced_features/ckg-queries.html">Retrieving data from the Clinical Knowledge Graph database</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced_features/standard-analysis.html">Standardizing the data analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced_features/visualization-plots.html">Visualization plots</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced_features/R-interface.html">Python - R interface</a></li>
</ul>
<p class="caption"><span class="caption-text">System Requirements</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../system_require/mac-os.html">Mac OS X requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../system_require/linux.html">Linux requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../system_require/windows.html">Windows requirements</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../src.html">Clinical Knowledge Graph package</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../MANIFEST.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../MANIFEST.html#backers">Backers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../MANIFEST.html#contributing">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../MANIFEST.html#history">History</a></li>
<li class="toctree-l1"><a class="reference internal" href="../MANIFEST.html#code-of-conduct">Code of Conduct</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">ClinicalKnowledgeGraph</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Getting Started with the CKG Build</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/intro/getting-started-with-build.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="getting-started-with-the-ckg-build">
<h1>Getting Started with the CKG Build<a class="headerlink" href="#getting-started-with-the-ckg-build" title="Permalink to this headline">Â¶</a></h1>
<p>Setting up the Clinical Knowledge Graph is straightforward.
Assuming you have <strong>Python 3.6</strong> already installed and added to <code class="docutils literal notranslate"><span class="pre">PATH</span></code>, you can choose to create a virtual environment where all the packages with the specific versions will be installed. To do so, use Virtualenv.</p>
<p>To check which Python version is currently installed:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ python3 --version
</pre></div>
</div>
<p>And where this Python version is:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ which python3
</pre></div>
</div>
<p>If this does not correspond to the correct Python version you want to run, you can create a shell alias in the bash file:</p>
<ol class="arabic simple">
<li><p>Open the bash file:</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ vi ~/.bash_profile
</pre></div>
</div>
<ol class="arabic simple">
<li><p>Add at the end of the file:</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">alias</span> <span class="nv">python3</span><span class="o">=</span><span class="s2">&quot;/path/to/correct/python3.6&quot;</span>
</pre></div>
</div>
<ol class="arabic simple">
<li><p>Save and close the bash file</p></li>
<li><p>Make the alias available in the current session:</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ <span class="nb">source</span> ~/.bash_profile
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you donât have <strong>Python 3.6</strong> installed, <a class="reference external" href="https://www.python.org/">download</a> the Python 3.6 version appropriate for your machine, and run the installer package. Python should be installed in <code class="docutils literal notranslate"><span class="pre">/Library/Frameworks/Python.framework/Versions/3.6/bin/python3.6</span></code> and also found in <code class="docutils literal notranslate"><span class="pre">/usr/local/bin/python3.6</span></code>.</p>
</div>
<div class="section" id="create-a-virtual-environment">
<h2>Create a virtual environment<a class="headerlink" href="#create-a-virtual-environment" title="Permalink to this headline">Â¶</a></h2>
<p>Virtualenv is not installed by default on Macbook machines. To install it, run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ python3 -m pip install virtualenv
</pre></div>
</div>
<p>To create a new virtual environment using a costum version of Python, follow the steps:</p>
<ol class="arabic simple">
<li><p>Take note of the full path to the Python version you would like to use inside the virtual environment.</p></li>
<li><p>Navigate to the directory where you would like your virtual environment to be (e.g. userâs root).</p></li>
<li><p>Create the virtual environment at the same time you specify the version of Python you wish to use. <code class="docutils literal notranslate"><span class="pre">env_name</span></code> is the name of the virtual environment and can be set to anything you like.</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ virtualenv -p /path/to/python env_name
</pre></div>
</div>
<ol class="arabic simple">
<li><p>Activate the virtual environment by running:</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ <span class="nb">source</span> path/to/env_name/bin/activate
</pre></div>
</div>
<p>After this, the name of the virtual environment will now appear on the left of the prompt:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">(</span>env_name<span class="o">)</span> username$
</pre></div>
</div>
<p>If you are finished working in the virtual environment for the moment, you can deactivate it by running:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ deactivate
</pre></div>
</div>
</div>
<div class="section" id="setting-up-the-clinical-knowledge-graph">
<h2>Setting up the Clinical Knowledge Graph<a class="headerlink" href="#setting-up-the-clinical-knowledge-graph" title="Permalink to this headline">Â¶</a></h2>
<p>The first step in setting up the CKG, is to obtain the complete code by clone the GitHub repository:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ git clone https://github.com/MannLabs/CKG.git
</pre></div>
</div>
<p>Once this is finished, you can find all the Python modules neccessary to run the Clinical Knowledge graph in <code class="docutils literal notranslate"><span class="pre">requirements.txt</span></code>.
To install all the packages required, simply run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ pip install -r requirements.txt
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Make sure the virtual environment previously created is active before installing <code class="docutils literal notranslate"><span class="pre">requirements.txt</span></code>.</p>
</div>
<p>Now that all the packages are correctly installed, you will have to create the appropriate directory architecture within the local copy of the cloned repository:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ <span class="nb">cd</span> CKG/
$ python setup_CKG.py
$ python setup_config_files.py
</pre></div>
</div>
<p>This will automatically create the <code class="docutils literal notranslate"><span class="pre">data</span></code> folder and all subfolders, as well as setup the configuration for the log files where
all errors and warnings related to the code will be written to.</p>
</div>
<div class="section" id="add-ckg-to-bashrc">
<h2>Add CKG to <em>.bashrc</em><a class="headerlink" href="#add-ckg-to-bashrc" title="Permalink to this headline">Â¶</a></h2>
<p>In order run the the Clinical Knowledge Graph, add the path to the code to your <code class="docutils literal notranslate"><span class="pre">.bashrc</span></code> (or <code class="docutils literal notranslate"><span class="pre">.bash_profile</span></code>):</p>
<ol class="arabic simple">
<li><p>Open the .bashrc file.</p></li>
<li><p>Add the following lines to the file and save it:</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">PYTHONPATH</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">PYTHONPATH</span><span class="si">}</span><span class="s2">:/path/to/folder/CKG/src/&quot;</span>
<span class="nb">export</span> PYTHONPATH
</pre></div>
</div>
<p>Notice that the path should always finish with â/CKG/src/â.</p>
<ol class="arabic simple">
<li><p>To reload the bash file, first deactivate the virtual environment, reload ~/.bashrc, and activate the virtual environment again:</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ deactivate
$ <span class="nb">source</span> ~/.bashrc
$ <span class="nb">source</span> path/to/env_name/bin/activate
</pre></div>
</div>
</div>
<div class="section" id="build-neo4j-graph-database">
<h2>Build Neo4j graph database<a class="headerlink" href="#build-neo4j-graph-database" title="Permalink to this headline">Â¶</a></h2>
<p>The building of the CKG database is thoroughly automated. most of the biomedical databases and ontology files will automatically be downloaded during building
of the database. However, the following have to be downloaded manually.</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.phosphosite.org/staticDownloads">PhosphoSitePlus</a>: <em>Acetylation_site_dataset.gz</em>, <em>Disease-associated_sites.gz</em>, <em>Kinase_Substrate_Dataset.gz</em>, <em>Methylation_site_dataset.gz</em>, <em>O-GalNAc_site_dataset.gz</em>, <em>O-GlcNAc_site_dataset.gz</em>, <em>Phosphorylation_site_dataset.gz</em>, <em>Regulatory_sites.gz</em>, <em>Sumoylation_site_dataset.gz</em> and <em>Ubiquitination_site_dataset.gz</em>.</p></li>
<li><p><a class="reference external" href="https://www.drugbank.ca/releases/latest">DrugBank</a>: <em>All drugs</em> and <em>DrugBank Vocabulary</em>.</p></li>
<li><p><a class="reference external" href="https://www.nlm.nih.gov/healthit/snomedct/us_edition.html">SNOMED-CT</a>: <em>Download SNOMED CT to ICD-10-CM Mapping Resources</em>.</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>These three databases require login and authentication. To sign up go to <a class="reference external" href="https://www.phosphosite.org/signUpAction">PSP Sign up</a>, <a class="reference external" href="https://www.drugbank.ca/public_users/sign_up">DrugBank Sign up</a> and <a class="reference external" href="https://uts.nlm.nih.gov/license.html">SNOMED-CT Sign up</a>. In the case of SNOMED-CT, the UMLS license can take several business days.</p>
</div>
<p>After download, move the files to their respective folders:</p>
<ul class="simple">
<li><p>PhosphoSitePlus: <code class="docutils literal notranslate"><span class="pre">CKG/data/databases/PhosphoSitePlus</span></code></p></li>
<li><p>DrugBank: <code class="docutils literal notranslate"><span class="pre">CKG/data/databases/DrugBank</span></code></p></li>
<li><p>SNOMED-CT: <code class="docutils literal notranslate"><span class="pre">CKG/data/ontologies/SNOMED-CT</span></code></p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the respective database folder is not created, please do it manually.</p>
</div>
<p>The last step is to build the database, which can be done using the <code class="docutils literal notranslate"><span class="pre">builder.py</span></code> module or a <code class="docutils literal notranslate"><span class="pre">dump</span> <span class="pre">file</span></code>.</p>
<div class="section" id="from-builder-py">
<h3>From builder.py<a class="headerlink" href="#from-builder-py" title="Permalink to this headline">Â¶</a></h3>
<p>To build the graph database, run <code class="docutils literal notranslate"><span class="pre">builder.py</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ <span class="nb">cd</span> src/graphdb_builder/builder
$ python builder.py -b full -u neo4j
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Before running <code class="docutils literal notranslate"><span class="pre">builder.py</span></code>, please make sure your Neo4j graph is running. The builder will fail otherwise.</p>
</div>
<p>This action will take aproximately 6 hours but depending on a multitude of factors, it can take up to 10 hours.</p>
</div>
<div class="section" id="from-a-backup-dump-file">
<h3>From a backup dump file<a class="headerlink" href="#from-a-backup-dump-file" title="Permalink to this headline">Â¶</a></h3>
<p>Alternatively, you can use the available dump file and load the graph database contained in it:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ <span class="nb">cd</span> /path/to/neo4jDatabases/database-identifier/installation-x.x.x/
$ mkdir backups
$ mkdir backups/graph.db
$ cp <span class="m">2019</span>-11-04.dump backups/graph.db/.
</pre></div>
</div>
<p>After copying the dump file to backups/graph.db/, make sure the graph database is shutdown and run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ bin/neo4j-admin load --from<span class="o">=</span>backups/graph.db/2019-11-04.dump --database<span class="o">=</span>graph.db --force
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Make sure the dump file naming in the command above, matches the one provided to you.</p>
</div>
<p>In some systems you might have to run this as root:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ sudo bin/neo4j-admin load --from<span class="o">=</span>backups/graph.db/2019-11-04.dump --database<span class="o">=</span>graph.db --force
$ sudo chown -R username data/databases/graph.db/
</pre></div>
</div>
<p>Another great use for the dump file, is to generate backups of the database (e.g. different versions of the imported biomedical databases).
To generate a dump file of a specific Neo4j database, simply run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ <span class="nb">cd</span> /path/to/neo4jDatabases/database-identifier/installation-x.x.x/
$ bin/neo4j-admin dump --database<span class="o">=</span>neo4j --to<span class="o">=</span>backups/graph.db/name_of_the_file.dump
</pre></div>
</div>
<p>Remember to replace âname_of_the_fileâ with the name of the dump file you want to create.</p>
<p>Once you are done, start the database and you are good to go!</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../getting_started/connect-to-ckg.html" class="btn btn-neutral float-right" title="Connecting to the Clinical Knowledge Graph database" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="getting-started-with-neo4j.html" class="btn btn-neutral float-left" title="Getting Started with Neo4j" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Alberto Santos, Ana Rita ColaÃ§o, Annelaura B. Nielsen

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>